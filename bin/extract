#!/usr/bin/env bash
# github: https://github.com/xvoland/Extract/blob/master/extract.sh

[ $# -eq 0 ] && {
	echo "usage: $(basename $0) [filenames]" >&2
	exit 1
}

for n in "$@"; do
	[ ! -f "$n" ] && {
		echo "$(basename $0): error: '$n' - file doesn't exist" >&2
		exit 1
	}
	case "${n#*.}" in
		cbt|tar.bz2|tar.gz|tar.xz|tbz2|tgz|txz|tar)
			tar xvf -p "$n" 
			;;
		lzma)
			unlzma ./"$n" 
			;;
		bz2)
			bunzip2 ./"$n" 
			;;
		cbr|rar)
			unrar x -ad ./"$n" 
			;;
		gz)
			gunzip ./"$n" 
			;;
		cbz|epub|zip)
			unzip ./"$n" 
			;;
		z)
			uncompress ./"$n" 
			;;
		7z|apk|arj|cab|cb7|chm|deb|iso|lzh|msi|pkg|rpm|udf|wim|xar|vhd)
			7z x ./"$n" 
			;;
		xz)
			unxz ./"$n" 
			;;
		exe)
			cabextract ./"$n" 
			;;
		cpio)
			cpio -id < ./"$n" 
			;;
		cba|ace)
			unace x ./"$n" 
			;;
		zpaq)
			zpaq x ./"$n" 
			;;
		arc)
			arc e ./"$n" 
			;;
		cso)
			ciso 0 ./"$n" ./"$n.iso" && extract "$n.iso" && \rm -f "$n" 
			;;
		zlib)
			zlib-flate -uncompress < ./"$n" > ./"$n.tmp" && mv ./"$n.tmp" ./"${n%.*zlib}" && rm -f "$n" 
			;;
		dmg)
			hdiutil mount ./"$n" -mountpoint "./$n.mounted"
			;;
		*)
			echo "$(basename $0): error: '$n' - unknown archive method" >&2
			exit 1
			;;
	esac
done
